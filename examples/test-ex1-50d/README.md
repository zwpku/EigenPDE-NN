## Example 1: A 50-dimensional system 

The dynamics of this system obeys the SDE <img src="https://render.githubusercontent.com/render/math?math=dX_t = -\nabla V(X_t)dt%2b\sqrt{2\beta^{-1}}dW_t"> where <img src="https://render.githubusercontent.com/render/math?math=V:\mathbb{R}^{50}\rightarrow\mathbb{R}"> is a potential function.
We choose <img src="https://render.githubusercontent.com/render/math?math=V=V_1(x_1,x_2)%2b5\sum_{i=3}^{50}x_i^2">, where the potential <img src="https://render.githubusercontent.com/render/math?math=V_1"> has 3 metastable regions. The training data for this example is generated by directly sampling the system's SDE using Euler-Maruyama scheme.

#### Steps to solve the eigenvalue PDE:

1. Enter the directory corresponding to this example

```
    cd ./EigenPDE-NN
    cd ./examples/test-ex1-50d
```

2. Generate trajectory data

	  Run the script [main.py](./main.py) by `python ./main.py`, and choose task 0 from input. 

	  Note: This step may take 30 minutes. The trajectory data (including weights) will be saved under `./data/`, whose filename is specified by the value of `data_filename_prefix` in [params.cfg](./params.cfg).

3. Train neural networks

	  Run the script [main.py](./main.py) by `python ./main.py`, and choose task 3 from input.

	  Note: This test will learn the first 3 eigenvalues/eigenfunctions. The training is divided into several stages, where different learning rates, batch-sizes can be specified. The trained model after the first training stage will be saved at `./data/eigen_vector_state1.pt`, and so on. The trained model after the entire training process will be saved at `./data/eigen_vector.pt`.

4. Evaluate trained neural networks on grid 

	  Run the script [main.py](./main.py) by `python ./main.py`, and choose task 4 from input.

	  Note: This step evaluates each trained eigenfunction on a grid of the first two coordinates (the rest coordinates are chosen randomly). This step generates text files that are needed to plot eigenfunctions.

#### Note:
To run the first example in paper [[1]](#1) with dimension 100, set `dim=100` in [params.cfg](./params.cfg). 
To run the first example in paper [[1]](#1) with dimension 2, set `dim=2` and `pot_id=5` in [params.cfg](./params.cfg).

<a id="1"> [1] </a> Solving eigenvalue PDEs of metastable diffusion processes using artificial neural networks, W. Zhang, T. Li and Ch. Sch&uuml;tte, 2021, 
[https://arxiv.org/abs/2110.14523](https://arxiv.org/abs/2110.14523)

#### Generate plots:
  Use scripts under [plot_scripts](../../plot_scripts/) **as templates** to generate plots. Before use, set the value of `task_id` in [common.py](../../plot_scripts/common.py).  The plots will be created under `./fig/`.

1. Data

  - [hist_of_data_in_1d_or_2d.py](../../plot_scripts/hist_of_data_in_1d_or_2d.py): 2D histogram of the first two coordinates of trajectory data.
  - [plot_potential_1d_or_2d.py](../../plot_scripts/plot_potential_1d_or_2d.py): plot potential function of the first two coordinates.

2. Training results

  - [plot_log_info.py](../../plot_scripts/plot_log_info.py): plot losses.
  - [plot_2d_evs_nn_and_FVD.py](../../plot_scripts/plot_2d_evs_nn_and_FVD.py): display eigenfunctions on the space of the first two coordinates.


