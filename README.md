# EigenPDE-solver-NN
An Eigenvalue PDE Solver by Neural Networks

This package trains artificial neural networks to solve the first several eigenvalues/eigenfunctions of the eigenvalue PDE problem 
<img src="https://render.githubusercontent.com/render/math?math=-\mathcal{L}f=\lambda f">, where ![formula](https://render.githubusercontent.com/render/math?math=\mathcal{L}) is the infiniesimal generator of certain type of stochastic diffusion processes whose invariant measure is ![formula](https://render.githubusercontent.com/render/math?math=\mu).

A trajectory data (possibly biased with biasing weights) is needed as training data. Such data can be generated either 
- using a numerical scheme (e.g., Euler-Maruyama scheme), for diffusion processes whose stochastic differential equation (SDE) is <img src="https://render.githubusercontent.com/render/math?math=dX_t = -\nabla V(X_t)dt%2b\sqrt{2\beta^{-1}}dW_t"> with a relatively simple potential <img src="https://render.githubusercontent.com/render/math?math=V">; or 
- using a molecular simulation package (e.g., NAMD), for molecular systems.

## Preparation
#### 1. Dependances (optional)

- [MDAnalysis](https://www.mdanalysis.org/) is used to load MD data. It is not needed if the training data is generated by sampling SDE (i.e. when the parameter namd_data_flag is set to False in [params.cfg](working_dir/params.cfg). 

- [slepc4py](https://pypi.org/project/slepc4py/) and [petsc4py](https://pypi.org/project/petsc4py/) are used in solving 2D eigenvalue PDE problems using finite volume method. In some examples, the solution given by finite volume method can be used to compare with the neural network solution. 
These two packages are not needed if one only wants to solve a PDE problem by training neural networks.

#### 2. Download the code 

```
	git clone https://github.com/zwpku/EigenPDE-solver-NN.git
```

## A model example of dimension 50.

#### 1. Enter the directory corresponding to this example.

```
  	cd ./EigenPDE-solver-NN
	cd ./test-ex1-50d
```

#### 3. Generate trajectory data

    Run the script [main.py](working_dir/main.py) 

```
   python ./main.py 
```
and choose task 0 from input.

#### 3. Train neural networks

    Run the script [main.py](working_dir/main.py)

```
   python ./main.py 
```
and choose task 3 from input.

## Alanine Dipeptide example 

